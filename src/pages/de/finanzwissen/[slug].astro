---
import BlogLayout from '../../../layouts/BlogLayout.astro';
import {
  contentfulClient,
  renderOptions
} from '../../../lib/contentful-client.js';
import { documentToHtmlString } from '@contentful/rich-text-html-renderer';
import '../../../styles/styles.css';
import '../../../styles/blog.css';

export async function getStaticPaths() {
  const entries = await contentfulClient.getEntries();
  return entries.items.map((entry) => ({
    params: { slug: entry.fields.slug }
  }));
}

const { slug } = Astro.params;
const post = await contentfulClient.getEntries({
  content_type: 'post',
  'fields.slug': slug
});

const postEntry = post.items.find(
  (item) => item.sys.contentType.sys.id === 'post'
);
---

<BlogLayout title={postEntry.fields.title}>
  <article
    class="wrapper-content-blog"
    set:html={documentToHtmlString(postEntry.fields.body, renderOptions)}
  />
</BlogLayout>
